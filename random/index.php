<?php//random initialization stuff    require_once("include.php");    global $mysqllocation, $mysqlusername, $mysqlpassword, $mysqldatabase, $numTables;    $db = new mysqli($mysqllocation, $mysqlusername, $mysqlpassword, $mysqldatabase);    date_default_timezone_set('Asia/Singapore');    $planID = 0;    $numTables = 5; //There this was done dirt cheap by my contractor in India    $query = "SELECT * FROM planList WHERE expiry > CURDATE() ORDER BY planID DESC";    $result = $db->query($query) or die($db->error);    $haveTable = false;    if($result->num_rows > 0)    {        $row = $result->fetch_assoc();        $planID = $row["planID"];        //now we have a seating arrangement, let's display it        $tables = array();        for($i = 0; $i < $numTables; $i++)            array_push($tables, array());        $query = "SELECT studentList.name, studentPlan.tableNum FROM studentPlan INNER JOIN studentList ON studentList.studentID = studentPlan.studentID WHERE studentPlan.planID = $planID";        $result = $db->query($query) or die($db->error);        while($row = $result->fetch_assoc())        {            array_push($tables[$row["tableNum"]], $row["name"]);        }        $outstr = "";        for($i = 0; $i < $numTables; $i++)        {            $outstr .= "<div class='tableBox'>";            foreach($tables[$i] as $person)            {                $outstr .= "<span>".$person."</span>";            }            $outstr .= "</div>";        }        $haveTable = true;    }    else    {        $outstr = "<div class='btn split' id='loadseat' onClick='loadseat()'><span>Get a new seating arrangement! :D</span></div>";    }?><!DOCTYPE html><html>    <head>        <meta charset="utf-8"/>        <link href="main.css" type="text/css" rel="stylesheet">        <link href='https://fonts.googleapis.com/css?family=Questrial' rel='stylesheet' type='text/css'>        <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>        <script>            var students = ["Amy", "Jun Da", "Chloe", "Yunan", "Minghao", "Ka Hui", "Adeline", "Zeqing", "Yidi", "Huang Zhong", "Illio", "Jeffrey", "Yicheng", "Matthew", "Samuel", "Xin Yun", "Yudong", "Edwin", "Yan An", "Simon", "Tian Tian", "Joy", "Ziqian", "Liying", "Jiahong"];            document.addEventListener('DOMContentLoaded', init, false);            window.onresize = resize;            var tables;            function init()            {                resize();                tables = document.getElementById("output").innerHTML;            }            function resize()            {                var ht = document.getElementById("menu-btns").getElementsByClassName("btn")[0].offsetHeight - 0.03 * document.body.offsetHeight;            }            function callRandStudent()            {                document.getElementById("output").innerHTML = randStudent();            }            function randStudent()            {                var r = Math.floor(Math.random() * students.length);                return students[r];            }            function showTableAllocation()            {                document.getElementById("output").innerHTML = tables;            }        </script>        <?php            if(!$haveTable)            {                ?>                <script type="text/javascript">                    function loadseat()                    {                        if(!confirm("Are you sure you want to generate a new seating arrangement? Once generated, it cannot be changed for 1 week."))                            return false;                        $("#output").load("generateTable.php", function (responseTxt, statusTxt, xhr)                        {                            if(statusTxt == "error")                                alert("Oops, something went wrong. Tell Yicheng this: " + xhr.status + ": " + xhr.statusText);                            tables = responseTxt;                        });                    }                </script>                <?php            }        ?>        <title>The Randomiser</title>    </head>    <body>        <div id="menu" class="disableSelect">            <div id="menu-btns">                <div class="btn split2" onClick="callRandStudent()">                    <span>Random Student</span>                </div>                <div class="btn split2" onClick="showTableAllocation()">                    <span>Table Allocation</span>                </div>            </div>        </div>        <div class="hr-divider pad-bottom"></div>        <div id="output">            <?php echo $outstr ?>        </div>        <div class="ahoot disableSelect">WOW</div>    </body></html>